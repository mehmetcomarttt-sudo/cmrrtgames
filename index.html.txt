<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KÄ±rmÄ±zÄ± Topu Bul Oyunu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            width: 100%;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .game-board {
            display: flex;
            justify-content: space-around;
            align-items: flex-end; 
            height: 200px;
            margin-top: 50px;
            position: relative;
        }

        .shell-container {
            width: 100px;
            height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            position: absolute; 
            /* KarÄ±ÅŸtÄ±rma sÄ±rasÄ±nda 'left' animasyonu */
            transition: left 0.5s ease-in-out; 
            cursor: pointer;
        }
        
        /* Top (Ball) Stili */
        .ball {
            width: 50px;
            height: 50px;
            background-color: #ff4136; /* KÄ±rmÄ±zÄ± */
            border-radius: 50%;
            position: absolute;
            bottom: 0; 
            z-index: 5; /* Kutudan (10) daha aÅŸaÄŸÄ±da */
            transition: opacity 0.3s;
        }
        
        /* Kutu (Shell) Stili */
        .shell {
            width: 100px;
            height: 100px;
            background-color: #a0a0a0;
            border-radius: 8px;
            position: relative;
            z-index: 10; /* Topu kapatÄ±r */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem; 
            line-height: 1;
            color: #4a5568; 
            box-shadow: 0 0px 15px rgba(0, 0, 0, 0.3);
            /* Sadece kutunun kalkmasÄ± iÃ§in transform eklenir */
            transition: transform 0.3s ease-out, background-color 0.3s; 
        }

        .shell:hover:not(.shuffling) {
            background-color: #909090;
        }
    </style>
</head>
<body>

    <div class="container mt-8">
        <h1 class="text-3xl font-bold text-center text-gray-700 mb-6">KÄ±rmÄ±zÄ± Topu Bul ðŸ”´</h1>

        <!-- Puan Paneli -->
        <div class="flex justify-around p-4 border-b border-gray-200 mb-6 bg-gray-50 rounded-lg">
            <div class="text-center">
                <p class="text-xl font-semibold text-green-600">DoÄŸru Tahmin</p>
                <span id="correct-count" class="text-3xl font-extrabold">0</span>
            </div>
            <div class="text-center">
                <p class="text-xl font-semibold text-red-600">YanlÄ±ÅŸ Tahmin</p>
                <span id="wrong-count" class="text-3xl font-extrabold">0</span>
            </div>
        </div>

        <!-- Oyun TahtasÄ± -->
        <div id="game-board" class="game-board">
            <!-- Kutular ve Toplar buraya JS ile eklenecek -->
        </div>

        <!-- Mesaj Kutusu -->
        <div id="message-box" class="text-gray-800">
            BaÅŸlamak iÃ§in 'KarÄ±ÅŸtÄ±r' butonuna tÄ±klayÄ±n.
        </div>
        
        <!-- Kontrol Butonu -->
        <div class="flex justify-center mt-8">
            <button id="shuffle-button" class="px-6 py-3 bg-indigo-600 text-white text-lg font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300">
                KarÄ±ÅŸtÄ±r
            </button>
        </div>
    </div>

    <script>
        // DOM Elementleri
        const gameBoard = document.getElementById('game-board');
        const shuffleButton = document.getElementById('shuffle-button');
        const messageBox = document.getElementById('message-box');
        const correctCountEl = document.getElementById('correct-count');
        const wrongCountEl = document.getElementById('wrong-count');

        // Oyun Durumu DeÄŸiÅŸkenleri
        let correctGuesses = 0;
        let wrongGuesses = 0;
        let ballLocation = 0; // 0, 1 veya 2
        let gameActive = false;
        let isShuffling = false;

        const SHELL_COUNT = 3;
        // KutularÄ±n baÅŸlangÄ±Ã§ X koordinatlarÄ± (Oyun tahtasÄ±na gÃ¶re ayarlanmÄ±ÅŸtÄ±r)
        const SHELL_POSITIONS = [50, 250, 450]; 

        // --- YardÄ±mcÄ± Fonksiyonlar ---

        function updateScoreDisplay() {
            correctCountEl.textContent = correctGuesses;
            wrongCountEl.textContent = wrongGuesses;
        }

        function createShellElement(index, hasBall) {
            const shellContainer = document.createElement('div');
            shellContainer.className = 'shell-container';
            shellContainer.id = `shell-${index}`;
            // BaÅŸlangÄ±Ã§ konumunu ayarla
            shellContainer.style.left = `${SHELL_POSITIONS[index]}px`;
            shellContainer.dataset.index = index;
            shellContainer.dataset.hasBall = hasBall;

            // KÄ±rmÄ±zÄ± Top (zeminde kalÄ±r)
            const ball = document.createElement('div');
            ball.className = 'ball';
            ball.style.opacity = '0'; // BaÅŸlangÄ±Ã§ta gizli
            shellContainer.appendChild(ball);

            // Kutu (Shell)
            const shell = document.createElement('div');
            shell.className = 'shell';
            shell.textContent = 'ðŸ“¦';
            shellContainer.appendChild(shell);

            shellContainer.addEventListener('click', () => handleGuess(shellContainer));
            return shellContainer;
        }

        function renderBoard() {
            gameBoard.innerHTML = '';
            // Yeni tur iÃ§in topu rastgele bir kutuya gizle
            ballLocation = Math.floor(Math.random() * SHELL_COUNT); 
            
            for (let i = 0; i < SHELL_COUNT; i++) {
                const hasBall = (i === ballLocation);
                const shellEl = createShellElement(i, hasBall);
                gameBoard.appendChild(shellEl);
            }
            
            // TahtayÄ± ortalamak iÃ§in geniÅŸliÄŸi ayarla
            gameBoard.style.width = `${SHELL_POSITIONS[SHELL_COUNT - 1] + 150}px`; 
        }

        // KutularÄ± karÄ±ÅŸtÄ±rÄ±r
        async function shuffleShells(iterations = 20, delay = 150) {
            const shells = Array.from(document.querySelectorAll('.shell-container'));
            isShuffling = true;
            shuffleButton.disabled = true;
            messageBox.textContent = "Kutular KarÄ±ÅŸtÄ±rÄ±lÄ±yor... OdaklanÄ±n!";

            // KutularÄ±n tÄ±klanmasÄ±nÄ± engellemek iÃ§in geÃ§ici sÄ±nÄ±f
            shells.forEach(shell => shell.classList.add('shuffling'));

            for (let i = 0; i < iterations; i++) {
                // Rastgele iki kutu seÃ§ ve takas et
                let index1 = Math.floor(Math.random() * SHELL_COUNT);
                let index2 = Math.floor(Math.random() * SHELL_COUNT);
                while (index1 === index2) {
                    index2 = Math.floor(Math.random() * SHELL_COUNT);
                }

                const shell1 = shells[index1];
                const shell2 = shells[index2];

                // Mevcut 'left' pozisyonlarÄ±nÄ± al
                const pos1 = parseFloat(shell1.style.left);
                const pos2 = parseFloat(shell2.style.left);

                // PozisyonlarÄ± takas et (CSS transition ile hareket baÅŸlar)
                shell1.style.left = `${pos2}px`;
                shell2.style.left = `${pos1}px`;

                // 'shells' dizisindeki referanslarÄ± takas et
                shells[index1] = shell2;
                shells[index2] = shell1;

                await new Promise(resolve => setTimeout(resolve, delay));
            }

            // KarÄ±ÅŸtÄ±rma bitti
            shells.forEach(shell => shell.classList.remove('shuffling'));
            isShuffling = false;
            gameActive = true;
            shuffleButton.disabled = true;
            messageBox.textContent = "Tahmin Et! Top hangi kutunun altÄ±nda?";
        }

        // TÃ¼m kutularÄ± aÃ§ar ve sonucu gÃ¶sterir
        function flipAllShells(isCorrect) {
            gameActive = false; // Oyun tahmin yapÄ±lana kadar durur
            shuffleButton.disabled = false;
            
            const shells = document.querySelectorAll('.shell-container');
            
            // TÃ¼m kutularÄ± aÃ§ ve topu gÃ¶ster
            shells.forEach(shellContainer => {
                const ballEl = shellContainer.querySelector('.ball');
                const shellEl = shellContainer.querySelector('.shell');

                // Kutuyu yukarÄ± kaydÄ±r (Sadece kutu elementi hareket eder)
                shellEl.style.transform = 'translateY(-50px)'; 
                shellEl.style.backgroundColor = '#c0c0c0';

                // Topu gÃ¶rÃ¼nÃ¼r yap (Sadece top olan kutuda gÃ¶rÃ¼nÃ¼r olacak)
                if (shellContainer.dataset.hasBall === 'true') {
                    ballEl.style.opacity = '1';
                }

                // Kutudan tÄ±klama olayÄ±nÄ± kaldÄ±r
                shellContainer.style.cursor = 'default';
                shellContainer.removeEventListener('click', () => handleGuess(shellContainer));
            });
            
            // SonuÃ§ mesajÄ±nÄ± gÃ¶ster
            if (isCorrect) {
                messageBox.textContent = "DOÄžRU BÄ°LDÄ°N! ðŸŽ‰ Yeni tur iÃ§in 'KarÄ±ÅŸtÄ±r'.";
                messageBox.classList.remove('text-red-600');
                messageBox.classList.add('text-green-600');
            } else {
                messageBox.textContent = "YANLIÅž TAHMÄ°N! ðŸ˜” Yeni tur iÃ§in 'KarÄ±ÅŸtÄ±r'.";
                messageBox.classList.remove('text-green-600');
                messageBox.classList.add('text-red-600');
            }
        }

        // --- Ana Oyun MantÄ±ÄŸÄ± ---

        function handleGuess(shellContainer) {
            if (!gameActive || isShuffling) return;

            const hasBall = shellContainer.dataset.hasBall === 'true';

            if (hasBall) {
                correctGuesses++;
                flipAllShells(true);
            } else {
                wrongGuesses++;
                flipAllShells(false);
            }

            updateScoreDisplay();
        }

        // KarÄ±ÅŸtÄ±r butonuna tÄ±klandÄ±ÄŸÄ±nda oyunu baÅŸlat
        shuffleButton.addEventListener('click', () => {
            renderBoard(); // Yeni bir top konumu ile tahtayÄ± sÄ±fÄ±rla
            shuffleShells();
            messageBox.classList.remove('text-green-600', 'text-red-600');
        });

        // Ä°lk oyun baÅŸlangÄ±cÄ±
        window.onload = () => {
            renderBoard();
            updateScoreDisplay();
            shuffleButton.disabled = false;
        };

    </script>
</body>
</html>